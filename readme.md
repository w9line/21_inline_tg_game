# Ochko 21

Telegram-бот для игры в 21 очко (Blackjack) на базе aiogram. Позволяет пользователям создавать комнаты, делать ставки, играть против дилера и управлять своим балансом.

## Функции

- **Создание игр**: Пользователи могут создавать новые комнаты для игры в 21 очко через inline-запросы.
- **Присоединение к играм**: До 71 игрока могут присоединиться к комнате.
- **Ставки**: Игроки делают ставки перед началом игры (минимум 10, максимум - баланс игрока).
- **Игровые ходы**: Взять карту (Hit), остановиться (Stand), удвоить ставку (Double).
- **Профили пользователей**: Просмотр статистики, баланса, максимальной ставки и серии побед.
- **Раздачи подарков**: Администратор может создавать раздачи денег для пользователей.
- **Админ-команды**: Специальные команды для выдачи подарков пользователям.
- **База данных**: SQLite для хранения игр, балансов, статистики и раздач.

## Установка

1. Клонируйте репозиторий:
   ```
   git clone https://github.com/yourusername/ochko_21.git
   cd ochko_21
   ```

2. Установите зависимости:
   ```
   pip install -r requirements.txt
   ```

3. Создайте файл `.env` в корне проекта и добавьте необходимые переменные (см. раздел Настройка).

4. Запустите бота:
   ```
   python main.py
   ```

## Настройка

Создайте файл `.env` со следующими переменными:

```
BOT_TOKEN=ваш_токен_бота_от_BotFather
REDIS_URL=redis://localhost:6379 (опционально, для кэширования)
LOG_LEVEL=INFO
MAX_PLAYERS=71
```

- `BOT_TOKEN`: Токен вашего Telegram-бота, полученный от @BotFather.
- `REDIS_URL`: URL для подключения к Redis (если используется).
- `LOG_LEVEL`: Уровень логирования (INFO, DEBUG и т.д.).
- `MAX_PLAYERS`: Максимальное количество игроков в одной игре (по умолчанию 71).

## Использование

1. **Создание игры**: В любом чате введите `@your_bot create` в inline-режиме.
2. **Присоединение**: Нажмите "Join" в сообщении с игрой.
3. **Ставки**: После присоединения всех игроков нажмите "Start". Затем каждый игрок делает ставку с помощью кнопок (x2, +10, Push и т.д.).
4. **Игра**: Во время игры используйте кнопки "Hit", "Stand" или "Double".
5. **Профиль**: Введите `@your_bot profile` для просмотра статистики.
6. **Раздачи**: Администратор может создать раздачу через `@your_bot gift limit amount`.

Админ-команды:
- В личные сообщения боту: `@username gifts (кол-во) (сумма)` - выдать подарок пользователю.

## Структура проекта

- `main.py`: Основная логика бота, обработчики команд и inline-запросов.
- `config.py`: Конфигурация приложения, загрузка переменных окружения.
- `database.py`: Класс для работы с SQLite базой данных.
- `game.py`: Логика игры, классы Player, Game, Deck и GameManager.
- `requirements.txt`: Список зависимостей Python.
- `.gitignore`: Файлы, игнорируемые Git.
- `readme.md`: Этот файл.

## Зависимости

- aiogram==3.0.0
- python-dotenv==1.0.0

Установите их с помощью `pip install -r requirements.txt`.

